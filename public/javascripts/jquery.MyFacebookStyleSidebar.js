/** * @author Paul Chan / KF Software House  * http://www.kfsoft.info * * Version 0.6 * Copyright (c) 2010 KF Software House * * Licensed under the MIT license: * http://www.opensource.org/licenses/mit-license.php * */	(function($) {    var _options = null;	var _mtm = null;	jQuery.fn.MyFacebookStyleSidebar = function(options) {		_options = $.extend({}, $.fn.MyFacebookStyleSidebar.defaults, options);		_mtm = this;				var path = window.location.pathname;		//remove spliter space  让分割线和上下块内容之间的间隔有1px距离		$(".spiter").each(function(){			$(this).parent().css("padding-top", "1px");			$(this).parent().css("padding-bottom", "1px");		});		//init content		if (_options.bInitPage)		{			$(this).each(function(){								var bIsIframe = $(this).hasClass("iframe");				var bIsAjax = $(this).hasClass("ajaxlink");				var a = $(this).find("a");				var href = a.attr("href");								//load first iframe or ajax page				if (bIsIframe || bIsAjax)				{					$(this).addClass("current");					$(a).append("<img class=loadingIco src='/images/loading.gif' />");					if (bIsIframe)						loadIframeWebpage(href);					else 						ajaxLoadWebpage(href);					return false;				}			});		}				//MAIN LOGIC		var bReturn = this.each(function()		{						//create menu			var loc = location.href;			var a = $(this).find("a");			var href = a.attr("href");			a.wrapInner("<span/>");						var bIsExtLink = $(this).hasClass("extlink");			var bIsIframe = $(this).hasClass("iframe");			var bIsimglink = $(this).hasClass("imglink");						$(a).click(function(){												$(".current").removeClass("current");				$(".loadingIco").remove();				//loading				if (!bIsimglink)				{					$(a).append("<img class=loadingIco src='/images/loading.gif'>");					$(a).parent().addClass("current");					}								if (bIsExtLink || bIsimglink) //external page				{					//do nothing					scrollToTop();				}				else if (bIsIframe) //iframe pagez				{					loadIframeWebpage(href);					return false;				}				else //localpage ajax				{					ajaxLoadWebpage(href); //MUST NOT BE CROSSDOMAIN					return false;				}			}).mouseenter(function(){				$(".hoverClass").removeClass("hoverClass");				var bIsCurrentClass = $(this).parent().hasClass("current");				var bIsimglink = $(this).parent().hasClass("imglink");				if (!bIsCurrentClass && !bIsimglink)					$(this).parent().addClass("hoverClass");			}).mouseout(function(){				$(".hoverClass").removeClass("hoverClass");			});					});		return bReturn;	}		function loadIframeWebpage(href)	{		$("#"+ _options.displayDivId).css("height", "auto");		$("#"+ _options.displayDivId).html("<IFRAME width=100% height=100% id='mainContentIframe' frameborder=0 src='"+ href +"'></IFRAME>")		$("#mainContentIframe").load(function(){			$(".loadingIco").remove();			$(".hoverClass").removeClass("hoverClass");			$("#"+ _options.displayDivId).html(data);			scrollToTop();		});	}	function ajaxLoadWebpage(href)	{		$("#"+ _options.displayDivId).css("height", "auto");		$.ajax({url: href,			success: function(data){								//alert(data);								$(".loadingIco").remove();				$(".hoverClass").removeClass("hoverClass");				$("#"+ _options.displayDivId).html(data);								var height = $("#"+ _options.displayDivId).height();				if (height < _options.pageMinHeight)					$("#"+ _options.displayDivId).css("height", _options.pageMinHeight);				scrollToTop();			},			cache:false		});	}		function scrollToTop()	{		$('html, body').animate( { scrollTop: 0 },250);	}	//default values	jQuery.fn.MyFacebookStyleSidebar.defaults = {		displayDivId: "mainContent",		pageMinHeight:800,		bInitPage: true	};		function endWith(str,pattern) {		var d = str.length - pattern.length;		return d >= 0 && str.lastIndexOf(pattern) === d;	};})(jQuery);